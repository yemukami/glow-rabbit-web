# リファクタリング作業タスク（次スレ用）

- 接続/同期ステータス共通ハンドラのテスト/抜け道確認を追加し、成功/失敗/切断/自動同期失敗のすべてでヘッダー・設置バッジが更新されることを固定化。
- 自動同期（接続後）と手動同期の競合を整理し、状態遷移（dirty→clean）をUIに確実反映する。
- startPos表示と実機挙動の乖離を補正（必要なら表示側でcurrentDist初期値補正や開始デバイス表示を追加）。
- まだ残るUI DOM操作をrenderer/view-modelへ寄せる（モーダル/オーバーレイの残りを洗い出す）。
- テスト拡充: 接続/同期ステータス表示、startPosの表示/反映、dirty→clean表示のスタブテストを追加。
